<!DOCTYPE html>
<html lang="en">

  <!-- Head -->
  <head>        
    <!-- Metadata, OpenGraph and Schema.org -->
    

    <!-- Standard metadata -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Garrett Grimm | MidiWriterJS - A JavaScript Library for Creating Expressive MIDI Files</title>
    <meta name="author" content="Garrett  Grimm" />
    <meta name="description" content="Garrett Grimm, Web Developer and Musician.
" />


    <!-- Bootstrap & MDB -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous" />

    <!-- Fonts & Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous">
    
    
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons">

    

    <!-- Styles -->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ü™¥</text></svg>">
    <link rel="stylesheet" href="/assets/css/main.css">
    <link rel="canonical" href="https://grimmdude.com/blog/2017/midiwriterjs/">

    <script src="https://cdn.jsdelivr.net/npm/@hotwired/turbo@8.0.4/dist/turbo.es2017-umd.min.js"></script>
    <!-- Dark Mode -->
    <script src="/assets/js/theme.js"></script>
    <script src="/assets/js/dark_mode.js"></script>
  </head>

  <!-- Body -->
  <body class="fixed-top-nav">

    <!-- Header -->
    <header>

      <!-- Nav Bar -->
      <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top">
        <div class="container">
          <a class="navbar-brand title font-weight-lighter" href="https://grimmdude.com/"><span class="font-weight-bold">Garrett</span>   Grimm</a>
          <!-- Navbar Toggle -->
          <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar top-bar"></span>
            <span class="icon-bar middle-bar"></span>
            <span class="icon-bar bottom-bar"></span>
          </button>

          <div class="collapse navbar-collapse text-right" id="navbarNav">
            <ul class="navbar-nav ml-auto flex-nowrap">

              <!-- About -->
              <li class="nav-item ">
                <a class="nav-link" href="/">about</a>
              </li>
              
              <!-- Blog -->
              <li class="nav-item active">
                <a class="nav-link" href="/blog/">blog</a>
              </li>

              <!-- Other pages -->
              <li class="nav-item ">
                <a class="nav-link" href="/projects/">projects</a>
              </li>

              <!-- Toogle theme mode -->
              <div class="toggle-container">
                <a id="light-toggle">
                  <i class="fas fa-moon"></i>
                  <i class="fas fa-sun"></i>
                </a>
              </div>
            </ul>
          </div>
        </div>
      </nav>
    </header>

    <!-- Content -->
    <div class="container mt-5">
      <!-- _layouts/post.html -->

<div class="post">

  <header class="post-header">
    <h1 class="post-title">MidiWriterJS - A JavaScript Library for Creating Expressive MIDI Files</h1>
    <p class="post-meta">January 26, 2017</p>
    <p class="post-tags">
      <a href="/blog/2017"> <i class="fas fa-calendar fa-sm"></i> 2017 </a>
      ¬† ¬∑ ¬†
        <a href="/blog/category/JavaScript">
          <i class="fas fa-tag fa-sm"></i> JavaScript</a> ¬†
          <a href="/blog/category/MIDI">
          <i class="fas fa-tag fa-sm"></i> MIDI</a> ¬†
          

    </p>
  </header>

  <article class="post-content">
    <p><a href="https://github.com/grimmdude/MidiWriterJS" title="View on GitHub" target="_blank" rel="noopener noreferrer">MidiWriterJS</a> is a small JavaScript library which provides an API for programatically generating MIDI files.  It supports most features of MIDI including multiple tracks, meta events such as key signature and time signature, velocity control, and more.</p>

<h2 id="about">About</h2>
<p>Being a musician and a programmer I‚Äôve always been interested in the MIDI file format and the possible web applications that could leverage it.  When I first started programming I really wanted to do something with MIDI so I looked up the <a href="http://cs.fit.edu/~ryan/cse4051/projects/midi/midi.html" target="_blank" rel="noopener noreferrer">spec</a> for the MIDI file format but was very intimidated by the details, like woah.  So I shelved it and proceeded to build simpler applications, many musical in nature, which helped me build my skillset.  What I like about about MIDI is how universal it is; once you have a MIDI file you can use one of the many applications available to play it, transpose it, notate it, and modify it.</p>

<p>Flash forward to the present; I thought it would be interesting to see if I could use the Web Audio API to record a single note and convert it to MIDI.  I got to the point where I could detect the frequency and duration of the note  and was ready to plug that data into a MIDI generating library for the conversion.  Thing is, I wasn‚Äôt having very good luck finding a suitable JavaScript library that did what I needed.  The thought of creating one myself crossed my mind so I went and took a second look at the MIDI file spec.  I pulled up the <a href="http://cs.fit.edu/~ryan/cse4051/projects/midi/midi.html" target="_blank" rel="noopener noreferrer">same web page</a> as I did years earlier and what do you know, it made much more sense than it did the first time I saw it.  I actually understood how the hex values worked and what byte length meant!  So at that point I was determined to put my programming knowledge to the test and write a MIDI file generator.</p>

<h2 id="purpose">Purpose</h2>
<p>By combining this library with a pitch and rhythm generating algorithm you could potentially create unique pieces of music.  With some basic constraints I would imagine you could get something sounding pretty good.  Another idea I had was using this library to create audio ‚Äúvisualizations‚Äù of a dataset.  For instance if you set some time based data to a beat, say one day equals one quarter note, and set the data points to pitches/velocity/octaves it could be consumed through the ears or even as written notation.</p>

<p>Of course you could also use this library in a more conventional way and incorporate it into some type of interface such as a piano roll or notation editor to provide a MIDI export feature.</p>

<h2 id="example">Example</h2>
<p>The full documentation can be found on the <a href="https://github.com/grimmdude/MidiWriterJS" target="_blank" rel="noopener noreferrer">GitHub page</a>, so I won‚Äôt go into too much detail here.  Though, here‚Äôs an example that should give you a basic idea of how the API is used to write the melody for ‚ÄúHot Cross Buns‚Äù:</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">MidiWriter</span> <span class="o">=</span> <span class="nf">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">midi-writer-js</span><span class="dl">'</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">track</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">MidiWriter</span><span class="p">.</span><span class="nc">Track</span><span class="p">();</span>
<span class="nx">track</span><span class="p">.</span><span class="nf">addEvent</span><span class="p">([</span>
            <span class="k">new</span> <span class="nx">MidiWriter</span><span class="p">.</span><span class="nc">NoteEvent</span><span class="p">({</span><span class="na">pitch</span><span class="p">:</span> <span class="p">[</span><span class="dl">'</span><span class="s1">E4</span><span class="dl">'</span><span class="p">,</span><span class="dl">'</span><span class="s1">D4</span><span class="dl">'</span><span class="p">],</span> <span class="na">duration</span><span class="p">:</span> <span class="dl">'</span><span class="s1">4</span><span class="dl">'</span><span class="p">}),</span>
            <span class="k">new</span> <span class="nx">MidiWriter</span><span class="p">.</span><span class="nc">NoteEvent</span><span class="p">({</span><span class="na">pitch</span><span class="p">:</span> <span class="p">[</span><span class="dl">'</span><span class="s1">C4</span><span class="dl">'</span><span class="p">],</span> <span class="na">duration</span><span class="p">:</span> <span class="dl">'</span><span class="s1">2</span><span class="dl">'</span><span class="p">}),</span>
            <span class="k">new</span> <span class="nx">MidiWriter</span><span class="p">.</span><span class="nc">NoteEvent</span><span class="p">({</span><span class="na">pitch</span><span class="p">:</span> <span class="p">[</span><span class="dl">'</span><span class="s1">E4</span><span class="dl">'</span><span class="p">,</span><span class="dl">'</span><span class="s1">D4</span><span class="dl">'</span><span class="p">],</span> <span class="na">duration</span><span class="p">:</span> <span class="dl">'</span><span class="s1">4</span><span class="dl">'</span><span class="p">}),</span>
            <span class="k">new</span> <span class="nx">MidiWriter</span><span class="p">.</span><span class="nc">NoteEvent</span><span class="p">({</span><span class="na">pitch</span><span class="p">:</span> <span class="p">[</span><span class="dl">'</span><span class="s1">C4</span><span class="dl">'</span><span class="p">],</span> <span class="na">duration</span><span class="p">:</span> <span class="dl">'</span><span class="s1">2</span><span class="dl">'</span><span class="p">}),</span>
            <span class="k">new</span> <span class="nx">MidiWriter</span><span class="p">.</span><span class="nc">NoteEvent</span><span class="p">({</span><span class="na">pitch</span><span class="p">:</span> <span class="p">[</span><span class="dl">'</span><span class="s1">C4</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">C4</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">C4</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">C4</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">D4</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">D4</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">D4</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">D4</span><span class="dl">'</span><span class="p">],</span> <span class="na">duration</span><span class="p">:</span> <span class="dl">'</span><span class="s1">8</span><span class="dl">'</span><span class="p">}),</span>
            <span class="k">new</span> <span class="nx">MidiWriter</span><span class="p">.</span><span class="nc">NoteEvent</span><span class="p">({</span><span class="na">pitch</span><span class="p">:</span> <span class="p">[</span><span class="dl">'</span><span class="s1">E4</span><span class="dl">'</span><span class="p">,</span><span class="dl">'</span><span class="s1">D4</span><span class="dl">'</span><span class="p">],</span> <span class="na">duration</span><span class="p">:</span> <span class="dl">'</span><span class="s1">4</span><span class="dl">'</span><span class="p">}),</span>
            <span class="k">new</span> <span class="nx">MidiWriter</span><span class="p">.</span><span class="nc">NoteEvent</span><span class="p">({</span><span class="na">pitch</span><span class="p">:</span> <span class="p">[</span><span class="dl">'</span><span class="s1">C4</span><span class="dl">'</span><span class="p">],</span> <span class="na">duration</span><span class="p">:</span> <span class="dl">'</span><span class="s1">2</span><span class="dl">'</span><span class="p">})</span>
    <span class="p">],</span> <span class="kd">function</span><span class="p">(</span><span class="nx">event</span><span class="p">,</span> <span class="nx">index</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// Sets the sequential property to true for all events</span>
    <span class="k">return</span> <span class="p">{</span><span class="na">sequential</span><span class="p">:</span><span class="kc">true</span><span class="p">};</span>
  <span class="p">}</span>
<span class="p">);</span>

<span class="kd">var</span> <span class="nx">write</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">MidiWriter</span><span class="p">.</span><span class="nc">Writer</span><span class="p">([</span><span class="nx">track</span><span class="p">]);</span>
<span class="nx">console</span><span class="p">.</span><span class="nf">log</span><span class="p">(</span><span class="nx">write</span><span class="p">.</span><span class="nf">dataUri</span><span class="p">());</span></code></pre></figure>

  </article>

</div>

    </div>

    <!-- Footer -->    
    <footer class="fixed-bottom">
      <div class="container mt-0">
        ¬© Copyright 2024 Garrett  Grimm. 
      </div>
    </footer>

    <!-- JavaScripts -->
    <!-- jQuery -->
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>

    <!-- Bootsrap & MDB scripts -->
  <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.2/dist/umd/popper.min.js" integrity="sha256-l/1pMF/+J4TThfgARS6KwWrk/egwuVvhRzfLAMQ6Ds4=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.min.js" integrity="sha256-SyTu6CwrfOhaznYZPoolVw2rxoY7lKYKQvqbtqN93HI=" crossorigin="anonymous"></script>

  

    
    

    

    <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-R2CRKS3K8J"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-R2CRKS3K8J');
  </script>
  </body>
</html>

